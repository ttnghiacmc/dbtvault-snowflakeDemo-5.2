-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."LINEITEM_PK", a."LINEITEM_HASHDIFF", a."COMMITDATE", a."DISCOUNT", a."EXTENDEDPRICE", a."LINE_COMMENT", a."QUANTITY", a."RECEIPTDATE", a."RETURNFLAG", a."SHIPDATE", a."SHIPINSTRUCT", a."SHIPMODE", a."TAX", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.dbt_ttnghiacmc.v_stg_orders AS a
    WHERE a."LINEITEM_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."LINEITEM_PK", stage."LINEITEM_HASHDIFF", stage."COMMITDATE", stage."DISCOUNT", stage."EXTENDEDPRICE", stage."LINE_COMMENT", stage."QUANTITY", stage."RECEIPTDATE", stage."RETURNFLAG", stage."SHIPDATE", stage."SHIPINSTRUCT", stage."SHIPMODE", stage."TAX", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert