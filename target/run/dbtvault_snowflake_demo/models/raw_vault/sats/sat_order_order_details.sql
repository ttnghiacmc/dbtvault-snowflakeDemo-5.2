

      create or replace transient table DV_PROTOTYPE_DB.dbt_ttnghiacmc.sat_order_order_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."ORDER_PK", a."ORDER_HASHDIFF", a."ORDERSTATUS", a."TOTALPRICE", a."ORDERDATE", a."ORDERPRIORITY", a."CLERK", a."SHIPPRIORITY", a."ORDER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.dbt_ttnghiacmc.v_stg_orders AS a
    WHERE a."ORDER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."ORDER_PK", stage."ORDER_HASHDIFF", stage."ORDERSTATUS", stage."TOTALPRICE", stage."ORDERDATE", stage."ORDERPRIORITY", stage."CLERK", stage."SHIPPRIORITY", stage."ORDER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
    